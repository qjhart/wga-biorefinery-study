drop SCHEMA IF EXISTS inl CASCADE;
CREATE SCHEMA inl;

SET search_path = inl, public,pg_catalog;
SET default_with_oids = false;

-- Our labor is a linear fit based on statistics from 2000-2006, on a
-- per state basis.  

drop table if exists labor_linear_fit;
create table labor_linear_fit (
  state_fips char(2),
  labor_type varchar(32),
  m float,
  b float
);

-- This table is the direct copy from INL Model, 

create temp table model_labor_input (
  state varchar(64),
  farm_m float,
  farm_b float,
  farm_2 float,
  truck_m float,
  truck_b float,
  truck_2 float,
  bulk_m float,
  bulk_b float,
  bulk_2 float,
  grind_m float,
  grind_b float,
  grind_2 float,
  plant_m float,
  plant_b float,
  plant_2 float
);

COPY model_labor_input from STDIN;
Alabama	0.2568	-504.81	8.33	0.198	-380.5	14.80	0.277	-542.3	10.42	-0.478	972.3	15.63	0.063	-113.8	11.80
Alaska	0.3031	-596.82	9.38	0.211	-402.5	19.73	0.372	-732.2	11.85	-0.720	1462.9	21.76	-0.327	670.3	16.41
Arizona	-0.0086	25.43	8.21	0.301	-586.4	16.45	-0.929	1873.3	15.55	-0.287	593.6	19.19	0.230	-447.9	11.19
Arkansas	0.2368	-465.73	7.55	0.314	-613.9	14.42	0.245	-478.7	10.19	0.669	-1326.3	10.97	0.245	-479.4	10.70
California	0.1507	-292.41	8.97	0.336	-656.3	16.21	0.749	-1487.0	10.42	0.639	-1257.1	20.12	0.461	-907.8	13.11
Colorado	1.0275	-2046.73	8.90	0.487	-959.0	15.58	0.721	-1430.4	11.23	0.294	-571.0	15.97	0.411	-810.1	11.95
Connecticut	0.3031	-596.82	9.38	0.379	-740.0	16.82	0.135	-258.4	12.30	0.891	-1765.7	17.68	0.208	-401.6	13.72
Delaware	0.3031	-596.82	9.38	0.410	-804.5	14.86	0.682	-1352.9	11.46	-0.241	498.5	16.27	-0.023	60.0	13.85
District of Columbia	0.3031	-596.82	9.38	0.448	-881.3	15.12	0.175	-337.1	13.23	0.135	-254.3	16.33	0.091	-168.1	13.88
Florida	0.4346	-860.90	8.48	0.164	-314.0	14.60	0.485	-959.8	9.90	0.162	-310.6	12.70	0.272	-532.1	11.24
Georgia	0.1939	-380.51	8.12	0.051	-86.1	16.47	0.514	-1017.8	10.02	0.043	-71.0	13.96	0.276	-540.0	11.34
Hawaii	0.1425	-274.85	10.25	0.319	-621.2	16.30	0.522	-1032.4	11.98	-1.550	3126.8	28.68	0.636	-1258.3	14.02
Idaho	0.2264	-444.26	8.15	-0.098	211.3	14.37	0.594	-1179.2	9.37	0.257	-500.0	13.92	0.012	-13.0	11.52
Illinois	0.6229	-1234.99	10.99	0.232	-446.7	17.19	-0.376	765.8	13.36	-0.627	1278.5	22.71	0.281	-548.3	13.16
Indiana	0.0318	-51.49	12.27	0.298	-580.2	16.21	0.363	-713.5	11.88	0.457	-896.8	16.79	0.272	-531.0	12.77
Iowa	0.2554	-500.27	10.85	0.095	-174.8	14.97	0.010	-7.0	12.70	0.083	-149.4	15.83	0.158	-304.3	12.24
Kansas	0.4039	-796.87	10.75	0.197	-378.5	15.39	0.694	-1378.2	9.99	0.364	-713.7	13.85	0.311	-610.5	11.35
Kentucky	-0.0221	55.53	10.54	0.236	-456.9	14.34	0.500	-987.9	11.76	0.473	-931.7	13.23	0.361	-710.3	11.95
Louisiana	0.2950	-582.85	7.05	0.062	-110.1	13.95	0.152	-293.7	10.23	0.270	-526.3	11.69	0.192	-372.6	11.06
Maine	0.2672	-524.92	9.38	0.292	-569.9	13.52	0.985	-1960.5	9.94	0.342	-670.9	13.67	0.418	-823.8	11.44
Maryland	0.3552	-698.10	9.38	0.375	-734.4	15.69	0.190	-368.3	11.89	0.369	-723.6	14.72	0.308	-603.1	13.31
Massachusetts	0.3031	-596.82	9.38	0.371	-724.6	17.66	0.245	-477.5	12.62	0.939	-1857.1	20.54	0.350	-685.8	13.84
Michigan	0.0076	-3.40	11.15	0.447	-877.2	15.94	0.033	-53.6	12.91	0.617	-1217.6	16.19	0.256	-496.2	16.07
Minnesota	0.3079	-604.69	11.02	0.152	-286.6	16.58	0.814	-1616.1	11.50	1.161	-2305.7	16.39	0.317	-621.0	13.80
Mississippi	-0.1711	351.57	9.21	0.259	-503.8	14.40	0.029	-46.0	10.78	-0.208	429.6	13.15	0.127	-243.0	10.73
Missouri	0.5054	-1004.16	6.79	0.126	-234.5	16.84	0.412	-812.0	11.50	0.623	-1232.7	14.60	0.292	-571.6	11.66
Montana	0.6393	-1269.36	8.97	0.223	-431.9	13.86	0.989	-1967.7	11.02	0.237	-456.4	16.60	0.413	-815.2	11.58
Nebraska	0.1986	-386.80	9.99	0.071	-125.7	14.96	-0.062	135.4	12.25	0.384	-752.1	16.27	0.192	-371.9	12.07
Nevada	0.3031	-596.82	9.38	0.611	-1206.4	15.59	0.696	-1380.9	11.36	-0.132	282.5	17.63	-0.010	33.2	13.74
New Hampshire	0.3031	-596.82	9.38	0.695	-1375.7	14.13	0.866	-1719.7	12.19	0.311	-607.0	15.41	0.295	-578.7	11.91
New Jersey	0.2185	-427.25	9.79	0.335	-652.5	17.05	0.491	-968.6	13.05	-0.255	531.4	20.32	0.272	-529.9	13.55
New Mexico	0.2057	-403.20	7.92	0.488	-963.0	13.61	0.381	-749.1	15.95	-0.376	770.5	19.34	0.138	-264.3	10.68
New York	0.5386	-1068.63	9.00	0.394	-771.0	16.65	0.437	-863.5	11.05	0.281	-544.5	18.06	0.211	-408.4	13.69
North Carolina	0.0239	-39.13	8.59	0.276	-536.6	15.22	0.592	-1174.4	10.24	0.088	-162.0	13.71	0.241	-471.1	11.74
North Dakota	0.5581	-1107.15	9.38	0.424	-834.6	14.03	0.116	-219.7	12.87	0.339	-658.8	18.02	0.737	-1463.4	11.14
Ohio	0.4961	-981.67	10.23	0.277	-538.1	16.03	0.387	-761.2	12.27	-0.637	1292.0	18.42	0.115	-217.4	13.27
Oklahoma	0.0186	-29.02	8.38	0.275	-535.9	14.25	0.054	-97.7	10.52	0.363	-713.8	11.95	0.253	-493.9	11.11
Oregon	0.5968	-1184.43	8.91	0.206	-397.0	15.53	0.225	-436.9	12.81	-0.157	331.8	18.04	0.377	-741.5	12.75
Pennsylvania	1.1286	-2246.79	10.89	0.079	-140.9	16.55	0.077	-140.3	13.75	-0.234	483.9	15.60	0.209	-404.1	12.85
Rhode Island	0.3031	-596.82	9.38	0.477	-938.0	15.18	0.472	-933.4	11.42	0.052	-85.6	18.44	0.663	-1314.2	11.51
South Carolina	0.5554	-1102.86	8.13	0.064	-111.5	15.73	0.308	-604.7	11.59	0.134	-255.1	13.18	0.303	-595.6	11.36
South Dakota	0.3089	-608.17	8.67	0.020	-24.9	14.39	0.296	-582.3	9.51	0.411	-808.4	12.85	0.182	-353.2	11.11
Tennessee	0.2532	-498.80	8.41	-0.064	144.0	16.45	0.248	-483.3	12.34	0.164	-314.9	12.82	0.277	-541.4	11.62
Texas	0.2718	-536.98	6.50	0.246	-477.4	14.65	0.211	-410.9	10.30	0.071	-128.4	12.84	0.161	-311.4	10.71
Utah	-0.1239	258.92	11.01	0.335	-654.5	16.35	0.757	-1501.9	10.92	0.036	-56.7	15.87	0.299	-586.7	11.51
Vermont	-0.0207	52.56	10.75	0.464	-915.0	13.12	0.883	-1756.9	9.44	0.650	-1288.1	12.05	-0.243	499.5	13.33
Virginia	0.2208	-432.11	9.02	0.141	-266.5	15.16	0.258	-504.8	11.08	0.513	-1014.2	12.72	0.168	-324.2	12.31
Washington	0.7814	-1553.13	9.65	0.247	-477.0	16.63	0.559	-1103.9	12.74	0.271	-521.7	20.19	0.477	-940.0	13.62
West Virginia	0.3031	-596.82	9.38	0.155	-296.7	13.53	0.337	-658.7	16.37	0.141	-264.5	16.98	-0.024	61.9	12.34
Wisconsin	0.2557	-499.86	12.07	0.182	-346.3	16.92	0.848	-1685.5	10.91	-0.016	50.9	18.84	0.206	-398.3	13.00
Wyoming	0.0868	-163.25	11.40	0.613	-1213.0	13.87	-0.042	102.9	19.39	-0.397	814.5	20.32	-0.023	61.8	16.75
\.

-- Now we copy the INL table into our schema.
insert into labor_linear_fit (state_fips,labor_type,m,b)
select n.state_fips::char(2),'farm' as type, farm_m as m, farm_b as b 
from model_labor_input m left join network.state n using (state) 
union 
select n.state_fips::char(2),'truck' as type, truck_m as m, truck_b as b 
from model_labor_input m left join network.state n using (state) 
union 
select n.state_fips::char(2),'bulk' as type, bulk_m as m, bulk_b as b 
from model_labor_input m left join network.state n using (state) 
union select n.state_fips::char(2),'grind' as type, grind_m as m, grind_b as b
from model_labor_input m left join network.state n using (state)
union select n.state_fips::char(2),'plant' as type, plant_m as m, plant_b as b
from model_labor_input m left join network.state n using (state);


-- Our labor is a linear fit based on statistics from 2000-2006, on a
-- per state basis.  

drop table if exists land_rent_linear_fit;
create table land_rent_linear_fit (
  state_fips char(2),
  m float,
  b float
);

-- This table is the direct copy from INL Model, 

create temp table model_land_rent_input (
  state varchar(64),
  m float,
  b float
);

COPY model_land_rent_input from STDIN;
Alabama	0.9643	-1895.32
Alaska	2.0262	-3983.90
Arizona	6.8452	-13563.81
Arkansas	1.7500	-3433.25
California	4.6429	-8988.21
Colorado	-0.0714	203.61
Connecticut	2.0262	-3983.90
Delaware	1.5024	-2949.77
District of Columbia	2.0262	-3983.90
Florida	1.2857	-2541.18
Georgia	1.2619	-2471.73
Hawaii	2.0262	-3983.90
Idaho	2.0000	-3906.25
Illinois	2.8929	-5669.46
Indiana	2.6548	-5212.44
Iowa	3.4762	-6839.05
Kansas	1.3869	-2737.60
Kentucky	1.2262	-2383.05
Louisiana	2.1024	-4147.60
Maine	2.0262	-3983.90
Maryland	1.3107	-2567.80
Massachusetts	2.0262	-3983.90
Michigan	1.4762	-2894.80
Minnesota	2.0024	-3927.60
Mississippi	1.6429	-3225.96
Missouri	2.7857	-5509.18
Montana	0.6417	-1260.29
Nebraska	2.5595	-5033.38
Nevada	2.0262	-3983.90
New Hampshire	2.0262	-3983.90
New Jersey	-0.1964	441.36
New Mexico	2.0262	-3983.90
New York	1.1905	-2348.12
North Carolina	1.0119	-1976.85
North Dakota	0.7381	-1441.15
Ohio	2.1845	-4296.13
Oklahoma	0.2440	-461.26
Oregon	1.6310	-3170.99
Pennsylvania	1.1369	-2234.60
Rhode Island	2.0262	-3983.90
South Carolina	0.5488	-1071.45
South Dakota	2.4952	-4952.43
Tennessee	1.4048	-2750.57
Texas	0.4357	-844.73
Utah	0.7143	-1370.57
Vermont	2.0262	-3983.90
Virginia	1.0893	-2143.70
Washington	7.0833	-14009.58
West Virginia	0.6310	-1235.99
Wisconsin	1.0119	-1958.73
Wyoming	2.0262	-3983.90
\.

-- Now we copy the INL table into our land_rent schema.
insert into land_rent_linear_fit (state_fips,m,b)
select n.state_fips::char(2),m as m, b as b 
from model_land_rent_input m left join network.state n using (state);

-- Some have depreciating Land rent, fix those;
update land_rent_linear_fit set m=0,b=b+m*2005 where m<0;

-- labor costs.  This is the connection to the labor costs needed for
-- the INL project.  Currently, we are using a linear fit, but the
-- interface is on a per county setup.

CREATE OR REPLACE FUNCTION inl.labor_cost(labor_type varchar(16), county_fips char(5), year float, OUT cost numeric) 
AS $$ select (b+m*$3)::decimal(6,2) as cost from inl.labor_linear_fit where state_fips=substr($2,1,2) and labor_type=$1 $$ LANGUAGE 'sql';

-- land rent costs are also linear fits of 2000-2006 data, and
-- definately are wrong, as we have some negative land rents.

CREATE OR REPLACE FUNCTION inl.land_rent(county_fips char(5), year float, OUT cost numeric) 
AS $$ select (b+m*$2)::decimal(6,2) as cost from inl.land_rent_linear_fit where state_fips=substr($1,1,2) $$ LANGUAGE 'sql';

drop table if exists state_vehicle_limits;
create table state_vehicle_limits (
  state_fips char(5),
  length int,
  width int,
  gvw float
);

drop table if exists state_sales_tax;
create table state_sales_tax (
  state_fips char(5),
  sales_tax float
);

drop table if exists state_year_fuel_cost;
create table state_year_fuel_cost (
  state_fips char(5),
  year int,
  on_road float,
  off_road float,
  excise float
);

-- I don't know how excise taxes were calculated.
create temp table model_tax_input (
  state varchar(64),
  length float,
  width float,
  height float,
  gvw float,
  sales_tax float,
  y2000_onroad float,
  y2000_excise float,
  y2000_offroad float,
  y2001_onroad float,
  y2001_excise float,
  y2001_offroad float,
  y2002_onroad float,
  y2002_excise float,
  y2002_offroad float,
  y2003_onroad float,
  y2003_excise float,
  y2003_offroad float,
  y2004_onroad float,
  y2004_excise float,
  y2004_offroad float,
  y2005_onroad float,
  y2005_excise float,
  y2005_offroad float,
  y2006_onroad float,
  y2006_excise float,
  y2006_offroad float,
  y2007_onroad float,
  y2007_excise float,
  y2007_offroad float,
  y2008_onroad float,
  y2008_excise float,
  y2008_offroad float,
  y2009_onroad float,
  y2009_excise float,
  y2009_offroad float,
  y2010_onroad float,
  y2010_excise float,
  y2010_offroad float,
  y2011_onroad float,
  y2011_excise float,
  y2011_offroad float,
  y2012_onroad float,
  y2012_excise float,
  y2012_offroad float,
  y2013_onroad float,
  y2013_excise float,
  y2013_offroad float,
  y2014_onroad float,
  y2014_excise float,
  y2014_offroad float,
  y2015_onroad float,
  y2015_excise float,
  y2015_offroad float,
  y2016_onroad float,
  y2016_excise float,
  y2016_offroad float,
  y2017_onroad float,
  y2017_excise float,
  y2017_offroad float,
  y2018_onroad float,
  y2018_excise float,
  y2018_offroad float,
  y2019_onroad float,
  y2019_excise float,
  y2019_offroad float,
  y2020_onroad float,
  y2020_excise float,
  y2020_offroad float,
  y2021_onroad float,
  y2021_excise float,
  y2021_offroad float,
  y2022_onroad float,
  y2022_excise float,
  y2022_offroad float,
  y2023_onroad float,
  y2023_excise float,
  y2023_offroad float,
  y2024_onroad float,
  y2024_excise float,
  y2024_offroad float,
  y2025_onroad float,
  y2025_excise float,
  y2025_offroad float,
  y2026_onroad float,
  y2026_excise float,
  y2026_offroad float,
  y2027_onroad float,
  y2027_excise float,
  y2027_offroad float,
  y2028_onroad float,
  y2028_excise float,
  y2028_offroad float,
  y2029_onroad float,
  y2029_excise float,
  y2029_offroad float,
  y2030_onroad float,
  y2030_excise float,
  y2030_offroad float
);

COPY model_tax_input (state,length,width,height,gvw,sales_tax,y2000_onroad,y2000_excise,y2000_offroad,y2001_onroad,y2001_excise,y2001_offroad,y2002_onroad,y2002_excise,y2002_offroad,y2003_onroad,y2003_excise,y2003_offroad,y2004_onroad,y2004_excise,y2004_offroad,y2005_onroad,y2005_excise,y2005_offroad,y2006_onroad,y2006_excise,y2006_offroad,y2007_onroad,y2007_excise,y2007_offroad,y2008_onroad,y2008_excise,y2008_offroad,y2009_onroad,y2009_excise,y2009_offroad,y2010_onroad,y2010_excise,y2010_offroad,y2011_onroad,y2011_excise,y2011_offroad,y2012_onroad,y2012_excise,y2012_offroad,y2013_onroad,y2013_excise,y2013_offroad,y2014_onroad,y2014_excise,y2014_offroad,y2015_onroad,y2015_excise,y2015_offroad,y2016_onroad,y2016_excise,y2016_offroad,y2017_onroad,y2017_excise,y2017_offroad,y2018_onroad,y2018_excise,y2018_offroad,y2019_onroad,y2019_excise,y2019_offroad,y2020_onroad,y2020_excise,y2020_offroad,y2021_onroad,y2021_excise,y2021_offroad,y2022_onroad,y2022_excise,y2022_offroad,y2023_onroad,y2023_excise,y2023_offroad,y2024_onroad,y2024_excise,y2024_offroad,y2025_onroad,y2025_excise,y2025_offroad,y2026_onroad,y2026_excise,y2026_offroad,y2027_onroad,y2027_excise,y2027_offroad,y2028_onroad,y2028_excise,y2028_offroad,y2029_onroad,y2029_excise,y2029_offroad,y2030_onroad,y2030_excise,y2030_offroad)  from STDIN;
Alabama	85	8.5	14	100000	4.00	1.44	0.43	1.01	1.35	0.43	0.91	1.28	0.43	0.84	1.45	0.43	1.02	1.74	0.42	1.32	2.35	0.43	1.92	2.66	0.43	2.22	2.82	0.45	2.37	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02	3.47	0.45	3.02
Alaska	\N	\N	\N	\N	0.00	1.61	0.32	1.28	1.50	0.32	1.17	1.40	0.32	1.08	1.61	0.32	1.29	2.02	0.32	1.70	2.57	0.32	2.24	2.87	0.32	2.55	3.04	0.32	2.72	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26	3.58	0.32	3.26
Arizona	\N	\N	\N	80000	5.60	1.61	0.50	1.10	1.50	0.50	0.99	1.40	0.50	0.90	1.61	0.50	1.11	2.02	0.50	1.52	2.57	0.50	2.06	2.87	0.42	2.45	3.04	0.42	2.62	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16	3.58	0.42	3.16
Arkansas	60	8.5	13.5	105500	6.00	1.44	0.47	0.97	1.35	0.47	0.87	1.28	0.47	0.81	1.45	0.47	0.98	1.74	0.47	1.27	2.35	0.47	1.88	2.66	0.47	2.19	2.82	0.47	2.35	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00
California	75	8.5	14	80000	7.25	1.68	0.42	1.25	1.55	0.42	1.12	1.45	0.42	1.02	1.65	0.42	1.23	2.09	0.42	1.67	2.60	0.42	2.18	2.93	0.42	2.51	3.09	0.42	2.67	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21	3.63	0.42	3.21
Colorado	110	8.5	16	85000	2.90	1.53	0.45	1.08	1.45	0.45	1.00	1.34	0.45	0.89	1.53	0.45	1.08	1.86	0.45	1.41	2.44	0.45	2.00	2.76	0.45	2.31	2.98	0.45	2.53	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01	3.46	0.45	3.01
Connecticut	\N	\N	\N	\N	6.00	1.62	0.42	1.19	1.49	0.42	1.07	1.40	0.50	0.90	1.64	0.50	1.14	1.92	0.50	1.42	2.51	0.50	2.01	2.82	0.50	2.31	2.98	0.61	2.37	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12	3.74	0.61	3.12
Delaware	\N	\N	\N	80000	0.00	1.61	0.46	1.14	1.48	0.46	1.01	1.40	0.46	0.94	1.63	0.46	1.17	1.90	0.46	1.44	2.50	0.46	2.03	2.81	0.46	2.35	2.97	0.46	2.50	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22	3.68	0.46	3.22
Dist. Of Columbia	\N	\N	\N	80000	5.75	1.61	0.44	1.16	1.48	0.44	1.03	1.40	0.44	0.96	1.63	0.44	1.19	1.90	0.44	1.46	2.50	0.44	2.05	2.81	0.47	2.34	2.97	0.47	2.50	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22	3.68	0.47	3.22
Florida	\N	\N	\N	80000	6.00	1.45	0.50	0.95	1.35	0.50	0.84	1.28	0.51	0.77	1.47	0.35	1.13	1.75	0.39	1.37	2.36	0.39	1.97	2.67	0.39	2.28	2.83	0.40	2.43	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11	3.51	0.40	3.11
Georgia	100	8.5	14.5	80000	4.00	1.45	0.32	1.13	1.35	0.32	1.03	1.28	0.32	0.96	1.47	0.32	1.16	1.75	0.32	1.44	2.36	0.32	2.04	2.67	0.32	2.35	2.83	0.32	2.51	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19	3.51	0.32	3.19
Hawaii	\N	\N	\N	\N	4.00	1.61	0.40	1.20	1.50	0.40	1.09	1.40	0.40	1.00	1.61	0.40	1.21	2.02	0.40	1.62	2.57	0.40	2.16	2.87	0.40	2.47	3.04	0.40	2.64	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18	3.58	0.40	3.18
Idaho	115	8.5	14	105500	6.00	1.53	0.49	1.03	1.45	0.49	0.96	1.34	0.49	0.85	1.53	0.49	1.04	1.86	0.49	1.37	2.44	0.49	1.95	2.76	0.49	2.26	2.98	0.49	2.49	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96	3.46	0.49	2.96
Illinois	60	8.5	13.5	80000	6.25	1.47	0.46	1.01	1.41	0.46	0.95	1.30	0.46	0.84	1.49	0.46	1.03	1.77	0.46	1.31	2.36	0.46	1.90	2.67	0.46	2.21	2.86	0.46	2.40	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02
Indiana	\N	\N	\N	80000	6.00	1.47	0.40	1.07	1.41	0.40	1.00	1.30	0.40	0.90	1.49	0.40	1.08	1.77	0.40	1.36	2.36	0.40	1.95	2.67	0.40	2.26	2.86	0.40	2.46	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08	3.48	0.40	3.08
Iowa	\N	\N	\N	80000	5.00	1.47	0.47	1.00	1.41	0.47	0.94	1.30	0.47	0.83	1.49	0.47	1.02	1.77	0.47	1.30	2.36	0.47	1.89	2.67	0.47	2.20	2.86	0.47	2.39	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01
Kansas	85	8.5	15	85500	5.30	1.47	0.46	1.01	1.41	0.47	0.93	1.30	0.49	0.81	1.49	0.50	0.98	1.77	0.50	1.26	2.36	0.50	1.85	2.67	0.50	2.16	2.86	0.50	2.36	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98	3.48	0.50	2.98
Kentucky	\N	\N	\N	80000	6.00	1.47	0.38	1.09	1.41	0.38	1.03	1.30	0.38	0.92	1.49	0.38	1.11	1.77	0.39	1.38	2.36	0.40	1.96	2.67	0.41	2.26	2.86	0.42	2.44	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06	3.48	0.42	3.06
Louisiana	\N	\N	\N	88000	4.00	1.44	0.44	1.00	1.35	0.44	0.90	1.28	0.44	0.83	1.45	0.44	1.01	1.74	0.44	1.30	2.35	0.44	1.91	2.66	0.44	2.21	2.82	0.44	2.38	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03
Maine	\N	\N	\N	100000	5.00	1.62	0.47	1.14	1.49	0.47	1.02	1.40	0.47	0.93	1.64	0.45	1.19	1.92	0.50	1.42	2.51	0.51	2.00	2.82	0.51	2.30	2.98	0.52	2.46	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22	3.74	0.52	3.22
Maryland	\N	\N	\N	80000	6.00	1.61	0.49	1.12	1.48	0.49	0.99	1.40	0.49	0.91	1.63	0.48	1.15	1.90	0.48	1.42	2.50	0.49	2.01	2.81	0.49	2.33	2.97	0.49	2.48	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20	3.68	0.49	3.20
Massachusetts	\N	\N	\N	\N	5.00	1.62	0.45	1.16	1.49	0.45	1.04	1.40	0.45	0.95	1.64	0.45	1.19	1.92	0.45	1.47	2.51	0.45	2.06	2.82	0.45	2.36	2.98	0.45	2.53	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28	3.74	0.45	3.28
Michigan	\N	\N	\N	160001	6.00	1.47	0.39	1.08	1.41	0.39	1.01	1.30	0.39	0.91	1.49	0.39	1.09	1.77	0.39	1.37	2.36	0.39	1.96	2.67	0.39	2.27	2.86	0.39	2.47	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09	3.48	0.39	3.09
Minnesota	75	8.5	13.5	80000	6.50	1.47	0.44	1.03	1.41	0.44	0.96	1.30	0.44	0.86	1.49	0.44	1.04	1.77	0.44	1.32	2.36	0.44	1.91	2.67	0.44	2.22	2.86	0.44	2.42	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04	3.48	0.44	3.04
Mississippi	\N	\N	\N	80000	7.00	1.44	0.43	1.01	1.35	0.43	0.92	1.28	0.43	0.85	1.45	0.43	1.02	1.74	0.43	1.32	2.35	0.43	1.92	2.66	0.42	2.23	2.82	0.42	2.40	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05	3.47	0.42	3.05
Missouri	\N	\N	\N	80000	4.23	1.47	0.41	1.06	1.41	0.41	0.99	1.30	0.41	0.89	1.49	0.41	1.07	1.77	0.41	1.35	2.36	0.41	1.94	2.67	0.41	2.25	2.86	0.41	2.45	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07
Montana	\N	\N	\N	132000	0.00	1.53	0.52	1.01	1.45	0.52	0.93	1.34	0.52	0.82	1.53	0.52	1.01	1.86	0.52	1.34	2.44	0.52	1.92	2.76	0.52	2.23	2.98	0.52	2.46	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94	3.46	0.52	2.94
Nebraska	\N	\N	\N	94000	5.50	1.47	0.48	0.99	1.41	0.49	0.92	1.30	0.49	0.81	1.49	0.49	1.00	1.77	0.49	1.28	2.36	0.50	1.86	2.67	0.51	2.16	2.86	0.51	2.35	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97	3.48	0.51	2.97
Nevada	\N	\N	\N	129000	6.50	1.61	0.52	1.08	1.50	0.52	0.97	1.40	0.52	0.88	1.61	0.52	1.09	2.02	0.51	1.51	2.57	0.51	2.05	2.87	0.51	2.36	3.04	0.51	2.53	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07	3.58	0.51	3.07
New Hampshire	\N	\N	\N	80000	0.00	1.62	0.44	1.18	1.49	0.44	1.05	1.40	0.44	0.96	1.64	0.42	1.22	1.92	0.42	1.50	2.51	0.42	2.09	2.82	0.42	2.39	2.98	0.42	2.56	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31	3.74	0.42	3.31
New Jersey	\N	\N	\N	80000	7.00	1.61	0.38	1.23	1.48	0.38	1.10	1.40	0.38	1.02	1.63	0.38	1.25	1.90	0.38	1.52	2.50	0.38	2.12	2.81	0.38	2.43	2.97	0.38	2.59	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31	3.68	0.38	3.31
New Mexico	\N	\N	\N	86400	5.00	1.44	0.44	1.00	1.35	0.44	0.91	1.28	0.44	0.84	1.45	0.44	1.01	1.74	0.47	1.27	2.35	0.47	1.88	2.66	0.47	2.19	2.82	0.47	2.35	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00	3.47	0.47	3.00
New York	\N	\N	\N	\N	4.00	1.61	0.45	1.16	1.48	0.45	1.03	1.40	0.45	0.95	1.63	0.45	1.18	1.90	0.45	1.45	2.50	0.46	2.04	2.81	0.47	2.35	2.97	0.47	2.49	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21	3.68	0.47	3.21
North Carolina	\N	\N	\N	80000	4.25	1.45	0.49	0.97	1.35	0.49	0.86	1.28	0.47	0.81	1.47	0.49	0.99	1.75	0.49	1.26	2.36	0.52	1.84	2.67	0.55	2.12	2.83	0.54	2.29	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96	3.51	0.54	2.96
North Dakota	\N	\N	\N	105500	5.00	1.47	0.45	1.02	1.41	0.45	0.95	1.30	0.45	0.85	1.49	0.45	1.03	1.77	0.45	1.31	2.36	0.47	1.88	2.67	0.47	2.19	2.86	0.47	2.39	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01	3.48	0.47	3.01
Ohio	\N	\N	\N	80000	5.50	1.47	0.46	1.01	1.41	0.46	0.94	1.30	0.46	0.84	1.49	0.48	1.00	1.77	0.50	1.26	2.36	0.52	1.83	2.67	0.52	2.14	2.86	0.52	2.34	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96	3.48	0.52	2.96
Oklahoma	\N	\N	\N	90000	4.50	1.47	0.38	1.09	1.41	0.38	1.02	1.30	0.37	0.93	1.49	0.37	1.11	1.77	0.37	1.39	2.36	0.37	1.98	2.67	0.37	2.29	2.86	0.37	2.49	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11	3.48	0.37	3.11
Oregon	\N	\N	\N	105500	0.00	1.61	0.48	1.12	1.50	0.48	1.01	1.40	0.48	0.92	1.61	0.48	1.13	2.02	0.48	1.54	2.57	0.48	2.08	2.87	0.48	2.39	3.04	0.48	2.56	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10	3.58	0.48	3.10
Pennsylvania	\N	\N	\N	80000	6.00	1.61	0.55	1.05	1.48	0.55	0.92	1.40	0.56	0.84	1.63	0.55	1.08	1.90	0.56	1.35	2.50	0.61	1.89	2.81	0.63	2.19	2.97	0.63	2.34	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06	3.68	0.63	3.06
Rhode Island	\N	\N	\N	80000	7.00	1.62	0.53	1.08	1.49	0.53	0.96	1.40	0.53	0.87	1.64	0.54	1.10	1.92	0.54	1.38	2.51	0.54	1.97	2.82	0.54	2.27	2.98	0.54	2.44	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19	3.74	0.54	3.19
South Carolina	\N	\N	\N	80000	6.00	1.45	0.40	1.05	1.35	0.40	0.94	1.28	0.40	0.87	1.47	0.40	1.07	1.75	0.40	1.35	2.36	0.40	1.95	2.67	0.40	2.27	2.83	0.40	2.43	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10	3.51	0.40	3.10
South Dakota	\N	\N	\N	\N	4.00	1.47	0.46	1.01	1.41	0.46	0.94	1.30	0.46	0.84	1.49	0.46	1.02	1.77	0.46	1.30	2.36	0.46	1.89	2.67	0.46	2.20	2.86	0.46	2.40	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02	3.48	0.46	3.02
Tennessee	\N	\N	\N	80000	7.00	1.47	0.41	1.06	1.41	0.41	0.99	1.30	0.41	0.89	1.49	0.41	1.07	1.77	0.41	1.35	2.36	0.41	1.94	2.67	0.41	2.25	2.86	0.41	2.45	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07	3.48	0.41	3.07
Texas	110	8.5	14	80000	6.25	1.44	0.44	1.00	1.35	0.44	0.90	1.28	0.44	0.83	1.45	0.44	1.01	1.74	0.44	1.30	2.35	0.44	1.91	2.66	0.44	2.21	2.82	0.44	2.38	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03	3.47	0.44	3.03
Utah	\N	\N	\N	129000	4.65	1.53	0.49	1.04	1.45	0.49	0.96	1.34	0.49	0.85	1.53	0.48	1.05	1.86	0.48	1.38	2.44	0.49	1.96	2.76	0.49	2.27	2.98	0.49	2.49	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97	3.46	0.49	2.97
Vermont	\N	\N	\N	80000	6.00	1.62	0.50	1.11	1.49	0.50	0.99	1.40	0.50	0.90	1.64	0.50	1.14	1.92	0.50	1.42	2.51	0.49	2.02	2.82	0.49	2.32	2.98	0.49	2.49	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24	3.74	0.49	3.24
Virginia	\N	\N	\N	80000	5.00	1.45	0.40	1.05	1.35	0.40	0.94	1.28	0.40	0.87	1.47	0.40	1.07	1.75	0.40	1.35	2.36	0.40	1.95	2.67	0.40	2.27	2.83	0.42	2.41	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09	3.51	0.42	3.09
Washington	\N	\N	\N	105500	6.50	1.61	0.47	1.13	1.50	0.47	1.02	1.40	0.47	0.93	1.61	0.52	1.09	2.02	0.52	1.50	2.57	0.55	2.01	2.87	0.58	2.29	3.04	0.58	2.46	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00	3.58	0.58	3.00
West Virginia	\N	\N	\N	80000	6.00	1.45	0.50	0.95	1.35	0.50	0.85	1.28	0.50	0.78	1.47	0.49	0.98	1.75	0.49	1.26	2.36	0.51	1.84	2.67	0.51	2.16	2.83	0.56	2.27	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95	3.51	0.56	2.95
Wisconsin	\N	\N	\N	80000	5.00	1.47	0.51	0.96	1.41	0.52	0.89	1.30	0.52	0.78	1.49	0.52	0.96	1.77	0.53	1.23	2.36	0.54	1.82	2.67	0.54	2.13	2.86	0.54	2.32	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94	3.48	0.54	2.94
Wyoming	\N	\N	\N	117000	4.00	1.53	0.38	1.14	1.45	0.38	1.07	1.34	0.38	0.96	1.53	0.38	1.15	1.86	0.38	1.48	2.44	0.38	2.06	2.76	0.38	2.37	2.98	0.38	2.60	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07	3.46	0.38	3.07
\.

-- Now we copy the INL table into our schema.
insert into state_vehicle_limits (state_fips,length,width,gvw)
select n.state_fips::char(2),length, width, gvw 
from model_tax_input m left join network.state n using (state);

insert into state_sales_tax (state_fips,sales_tax)
select n.state_fips::char(2),sales_tax 
from model_tax_input m left join network.state n using (state);

insert into state_year_fuel_cost (state_fips,year,on_road,off_road,excise)
select n.state_fips::char(2),2000,y2000_onroad,y2000_offroad,y2000_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2001,y2001_onroad,y2001_offroad,y2001_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2002,y2002_onroad,y2002_offroad,y2002_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2003,y2003_onroad,y2003_offroad,y2003_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2004,y2004_onroad,y2004_offroad,y2004_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2005,y2005_onroad,y2005_offroad,y2005_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2006,y2006_onroad,y2006_offroad,y2006_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2007,y2007_onroad,y2007_offroad,y2007_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2008,y2008_onroad,y2008_offroad,y2008_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2009,y2009_onroad,y2009_offroad,y2009_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2010,y2010_onroad,y2010_offroad,y2010_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2011,y2011_onroad,y2011_offroad,y2011_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2012,y2012_onroad,y2012_offroad,y2012_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2013,y2013_onroad,y2013_offroad,y2013_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2014,y2014_onroad,y2014_offroad,y2014_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2015,y2015_onroad,y2015_offroad,y2015_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2016,y2016_onroad,y2016_offroad,y2016_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2017,y2017_onroad,y2017_offroad,y2017_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2018,y2018_onroad,y2018_offroad,y2018_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2019,y2019_onroad,y2019_offroad,y2019_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2020,y2020_onroad,y2020_offroad,y2020_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2021,y2021_onroad,y2021_offroad,y2021_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2022,y2022_onroad,y2022_offroad,y2022_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2023,y2023_onroad,y2023_offroad,y2023_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2024,y2024_onroad,y2024_offroad,y2024_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2025,y2025_onroad,y2025_offroad,y2025_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2026,y2026_onroad,y2026_offroad,y2026_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2027,y2027_onroad,y2027_offroad,y2027_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2028,y2028_onroad,y2028_offroad,y2028_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2029,y2029_onroad,y2029_offroad,y2029_excise
from model_tax_input m left join network.state n using (state)
union
select n.state_fips::char(2),2030,y2030_onroad,y2030_offroad,y2030_excise
from model_tax_input m left join network.state n using (state);

-- tax codes are not linear fits, They're averages of 2000-2008.  This
-- is crazy wrong, and needs to be fixed.  I used the table directly.

CREATE OR REPLACE FUNCTION inl.fuel_cost(county_fips char(5), year float, OUT on_road numeric, OUT off_road numeric, OUT excise numeric) 
AS $$ select on_road::decimal(6,2) as on_road, off_road::decimal(6,2) as off_road, excise::decimal(6,2) as excise from inl.state_year_fuel_cost where state_fips=substr($1,1,2) and year=$2 $$ LANGUAGE 'sql';


-- There are a few parameters that are maintained outside of the hard
-- coded model to allow for variation between states and over time.
-- These are labor rates, fuel costs and land rents.  The INL model
-- assumptions can be found in the -Y´State-specific¡ sheet of the
-- excel model.

-- Parameter notation

-- LCf   Farm labor rate ($/hr)
-- LCtd  Truck driver labor rate ($/hr)
-- LCpl  Plant loader operator labor rate ($/hr)
-- LCbh  Bulk handling labor rate ($/hr)
-- LCgo  Grinder labor rate ($/hr)
-- FCr On-road fuel cost ($/gallon)
-- FCo  Off-road fuel cost ($/gallon)
-- Rent  Land rent ($/acre) 


CREATE OR REPLACE FUNCTION inl.tons_per_truck_unit(OUT tons_per_truck varchar(32)) as $$
BEGIN
tons_per_truck:='Tons/truckload';
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION inl.tons_per_truck(material varchar(16), county_fips char(5), OUT tons_per_truck numeric) as $$
BEGIN
IF (material = 'bale') THEN
   tons_per_truck:=17; -- tons/truck  @ 26 *  0.65445 tons/bale
ELSIF (material = 'bulk') THEN
   tons_per_truck := 19.9; -- tons/truck @ 9.1 lb / ft 3
ELSE
   tons_per_truck:=18.5;
END IF;
END;
$$ LANGUAGE plpgsql;
 
--
-- To modify for Moisture Content, divide by (1-MC)
--
CREATE OR REPLACE FUNCTION inl.loading_cost_unit(OUT loading varchar(32), OUT unloading varchar(32)) as $$
BEGIN
loading:='$/Ton';
unloading:='$/Ton';
END;
$$ LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION inl.loading_cost(material varchar(16), county_fips char(5), year float, OUT loading numeric, OUT unloading numeric) as $$
DECLARE
FCo float;
LCpl float;
LCtd float;
LCbh float;
tons_per_truck float;
BEGIN
--    RAISE INFO material;
-- loading costs per truck
tons_per_truck:=inl.tons_per_truck(material,county_fips);
FCo := (inl.fuel_cost(county_fips,year)).off_road;
LCpl := inl.labor_cost('plant',county_fips,year);
LCtd := inl.labor_cost('truck',county_fips,year);
LCbh := inl.labor_cost('bulk',county_fips,year);
IF (material = 'bale') THEN
   loading:=(0.325*(6.71 + 1.67*LCpl) + 1.725*FCo + 0.56*1.67*LCtd);
   unloading:=loading;
ELSIF (material = 'bulk') THEN
   loading:=0.22*1.67*LCtd;
   unloading:=0.16667*(44.31 + 1.6*LCbh) + loading;
ELSIF (material = 'liquid') THEN
   loading:=2.24;
   unloading:=2.24;
ELSE
   loading:=0;
   unloading:=0;
END IF;
-- Then per ton
loading:=loading/tons_per_truck;
unloading:=unloading/tons_per_truck;
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION inl.travel_cost_unit(OUT cost varchar(32)) as $$
BEGIN
cost:='$/Ton';
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION inl.travel_cost(material varchar(16), county_fips char(5), year float, miles float, hours float, OUT cost numeric) as $$
DECLARE
FCr float;
LCtd float;
tons_per_truck float;
bd float;
d float;
BEGIN
tons_per_truck:=inl.tons_per_truck(material,county_fips);
FCr := (inl.fuel_cost(county_fips,year)).on_road;
LCtd := inl.labor_cost('truck',county_fips,year);
IF (material = 'bale') THEN
  cost:=2*((0.29 + (1.0/6.0)*FCr)*miles + 1.67*LCtd*hours) / tons_per_truck;
ELSIF (material = 'bulk') THEN
  cost:=2*((0.29 + (1.0/6.0)*FCr)*miles + 1.67*LCtd*hours) / tons_per_truck;
-- liquid cost , 5000 GAL/TRUCK (hence /50)
ELSIF (material = 'liquid') THEN
  cost:=2*((0.5424 + (1.0/6.0)*FCr)*miles + 1.67*LCtd*hours) / 50;
ELSE
  cost:=2*((0.29 + (1.0/6.0)*FCr)*miles + 1.67*LCtd*hours) / tons_per_truck;
END IF;
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION inl.transportation_cost_unit(OUT loading varchar(32), OUT unloading varchar(32), OUT travel varchar(32),OUT total varchar(32)) as $$
BEGIN
loading:='$/Ton';
unloading:='$/Ton';
travel:='$/Ton';
total:='$/Ton';
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION inl.transportation_cost(material varchar(16), county_fips char(5), year float, travel_miles float, travel_hours float, OUT loading numeric, OUT unloading numeric, OUT travel numeric,OUT total numeric) as $$
DECLARE
loading_cost record;
BEGIN
loading_cost:=inl.loading_cost(material,county_fips,year);
travel:=inl.travel_cost(material,county_fips,year,travel_miles,travel_hours);
loading:=loading_cost.loading;
unloading:=loading_cost.unloading;
total:=loading+unloading+travel;
END;
$$ LANGUAGE plpgsql;

-- Rail transportation
CREATE OR REPLACE FUNCTION inl.rail_cost_unit(material varchar(16),OUT loading varchar(32), OUT unloading varchar(32), OUT travel varchar(32),OUT total varchar(32)) as $$
BEGIN
IF (material = 'liquid') THEN
loading:='$/100gal';
unloading:='$/100gal';
travel:='$/100gal';
total:='$/100gal';
ELSE
loading:='$/Ton';
unloading:='$/Ton';
travel:='$/Ton';
total:='$/Ton';
END IF;
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION inl.rail_cost(material varchar(16), county_fips char(5),year float,travel_miles float,OUT loading numeric, OUT unloading numeric, OUT travel numeric, OUT total numeric) AS $$ 
BEGIN
IF (material = 'bale') THEN
  loading:=4.15+20.34;
  unloading:=4.15;
  travel:=0.0203*travel_miles;
ELSIF (material = 'bulk') THEN
  loading:=4.15+20.34;
  unloading:=4.15;
  travel:=0.0203*travel_miles;
-- liquid cost came from WGA project
ELSIF (material = 'liquid') THEN
  loading:=1.49+6.78;
  unloading:=1.49;
  travel:=0.0089*travel_miles;
ELSE
  loading:=4.15+20.34;
  unloading:=4.15;
  travel:=0.0203*travel_miles;
END IF;
total:=loading+unloading+travel; 
END;
$$ LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION inl.waterway_cost_unit(material varchar(16),OUT loading varchar(32), OUT unloading varchar(32), OUT travel varchar(32),OUT total varchar(32)) as $$
BEGIN
IF (material = 'liquid') THEN
loading:='$/100gal';
unloading:='$/100gal';
travel:='$/100gal';
total:='$/100gal';
ELSE
loading:='$/Ton';
unloading:='$/Ton';
travel:='$/Ton';
total:='$/Ton';
END IF;
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION inl.waterway_cost(material varchar(16), county_fips char(5),year float,travel_miles float,OUT loading numeric, OUT unloading numeric, OUT travel numeric, OUT total numeric) AS $$ 
BEGIN
IF (material = 'bale') THEN
  loading:=4.15+7.23;
  unloading:=4.15;
  travel:=0.0266*travel_miles;
ELSIF (material = 'bulk') THEN
  loading:=4.15+7.23;
  unloading:=4.15;
  travel:=0.0266*travel_miles;
ELSIF (material = 'liquid') THEN
  loading:=2.71+2.39;
  unloading:=2.71;
  travel:=0.0067*travel_miles;
ELSE
  loading:=4.15+7.23;
  unloading:=4.15;
  travel:=0.0266*travel_miles;
END IF;
  total:=loading+unloading+travel; 
END;
$$ LANGUAGE plpgsql;


-- Straw & Stover Harvest Cost (Bales) 
-- Maybe at one point, we can move the SSURGO parameters here.
CREATE OR REPLACE FUNCTION inl.residue(gross_residue float, 
     required_residue float, OUT  residue float) as $$
BEGIN
DECLARE
  residue:=inl.residue(gross_residue,required_residue,0.38);  
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION inl.residue(gross_residue float, 
  required_residue float, harvest_efficiency float,OUT residue float) as $$
DECLARE
BEGIN
  residue:= greatest(0,
            least(gross_residue*harvest_efficiency,
                  gross_residue-required_residue));
END;
$$ LANGUAGE plpgsql;

-- Windrowing & Baling
-- This should probably have bdt in terms of yield, since we include acres.
-- Please modify
CREATE OR REPLACE FUNCTION inl.harvest_cost_unit(OUT county_fips varchar(32), OUT year varchar(32), OUT acres varchar(32), OUT gross_residue_per_acre varchar(32), OUT required_residue_per_acre varchar(32), OUT windrowing varchar(32), OUT baling varchar(32), OUT roadsiding varchar(32), OUT wrapping varchar(32), OUT rent varchar(32), OUT insurance varchar(32), OUT total varchar(32)) as $$
BEGIN
county_fips='fips55';
year:='year';
acres:='acres';
gross_residue_per_acre:='BDT/acre';
required_residue_per_acre:='BDT/acre';
windrowing:='$/BDT';
baling:='$/BDT';
roadsiding:='$/BDT';
wrapping:='$/BDT';
rent:='$/acre';
insurance:='$/BDT ?';
total:='$/BDT';
END;
$$ LANGUAGE 'plpgsql';

CREATE OR REPLACE FUNCTION 
inl.harvest_cost(
county_fips char(5), year float, acres float, 
biomass_residue_bdt_per_acre float,
OUT windrowing decimal(6,2), OUT baling decimal(6,2), 
OUT roadsiding decimal(6,2), OUT wrapping decimal(6,2), 
OUT rent decimal(6,2), OUT insurance decimal(6,2), 
OUT total decimal(6,2)) as $$
DECLARE
FCo float;
LCf float;
ye float;
tons_per_truck float;
rf float;
BEGIN
--    RAISE INFO material;
FCo := (inl.fuel_cost(county_fips,year)).off_road;
LCf := inl.labor_cost('farm',county_fips,year);
ye:=biomass_residue_bdt_per_acre;
rf:=4*sqrt(acres*(0.0015625))/8; -- assume square farm, convert to avg. mi
-- If there was an aspect ratio r=l/w, 
-- this would be A=w*rw w=sqrt(A/r) P=2(1+r)sqrt(A/r)

windrowing := (40.82 + 1.1*LCf + 9.96*FCo)/(ye*7.3);
baling := (115.0 + 1.1*LCf + 12.46*FCo)/least(21.89,ye*10.72) + 1.28;
roadsiding:= (55.97 + 1.1*LCf + 8.85*FCo)/(5.184/(0.0413+ rf*0.1893));
wrapping:= (38.35 + 2.2*LCf + 2.88*FCo)/46.08 + 4.96;
rent:=inl.land_rent(county_fips,year)*(0.00063769);
insurance:=0.05;
total:=windrowing+baling+roadsiding+wrapping+rent+insurance;
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION 
inl.harvest_cost(
county_fips char(5), year float, acres float, 
gross_residue_per_acre float, required_residue_per_acre float, 
OUT windrowing decimal(6,2), OUT baling decimal(6,2), 
OUT roadsiding decimal(6,2), OUT wrapping decimal(6,2), 
OUT rent decimal(6,2), OUT insurance decimal(6,2), 
OUT total decimal(6,2)) as $$
DECLARE
r record;
BEGIN
r:=inl.harvest_cost(county_fips,year, acres , 
inl.residue(gross_residue_per_acre, required_residue_per_acre,0.38));

--biomass_bdt_per_acre decimal(6,2),
windrowing:=r.windrowing;
baling:=r.baling;
roadsiding:=r.roadsiding;
wrapping:=r.wrapping;
rent:=r.rent;
insurance:=r.insurance;
total:=r.total;
END;
$$ LANGUAGE plpgsql;


-- The preprocessing costs include the costs of
-- grinding, densifying and storing biomass at a depot. In the case
-- of the pioneer feedstock supply chain the depot is part of the
-- biorefinery. One additional parameter is needed for calculating the
-- preprocessing costs. The depot_size is the size of the depot in
-- dry tons per year. This can be calculated by summing the biomass
-- delivered to a depot (or biorefinery).

-- Plant handling and queing costs are incurred at the biorefinery and
-- represent the cost of the receiving equipment beyond unloading.
-- This includes a truck scale and asphalt pad for receiving.


CREATE OR REPLACE FUNCTION inl.preprocessing_cost(
       OUT county_fips varchar(32), 
       OUT year varchar(32),
       OUT facility_size varchar(32),
       OUT grinding varchar(32),
       OUT loading varchar(32),
       OUT handling varchar(32),
       OUT receiving varchar(32),
       OUT total varchar(32)) as $$
BEGIN
county_fips='fips55';
year:='year';
facility_size='TON/year';
grinding:='$/TON';
loading:='$/TON';
handling:='$/TON';
receiving:='$/TON';
total:='$/TON';
END;
$$ LANGUAGE 'plpgsql';

CREATE OR REPLACE FUNCTION inl.preprocessing(county_fips char(5), year float, 
       facility_size float, OUT grinding decimal(6,2), OUT loading decimal(6,2), 
       OUT handling decimal(6,2), OUT receiving decimal(6,2), OUT total decimal(6,2)) as $$
DECLARE
FCo float;
LCbh float;
LCpl float;
LCgo float;
grind_hr float = 73.3;
loader_hr float = 6.08;	 -- Loader operating cost per hr
facility_tons_hr float;
BEGIN
--    RAISE INFO material;
FCo := (inl.fuel_cost(county_fips,year)).off_road;
LCbh := inl.labor_cost('bulk',county_fips,year);
LCpl := inl.labor_cost('plant',county_fips,year);
LCgo := inl.labor_cost('grind',county_fips,year);

facility_tons_hr:=facility_size/8400; -- 24*7*50
-- 14.6 grinder tons/hr
grinding:= (grind_hr + 1.03*LCgo)*(ceil(facility_tons_hr/14.6))/facility_tons_hr;
-- 39.3 loader tons/hr
loading:=(loader_hr + 1.03*LCpl + 1.725*FCo)*(ceil(facility_tons_hr/39.3))/facility_tons_hr;
-- 14.6 grinder tons/hr ???
receiving:=47.16*(ceil(facility_tons_hr/14.6))/facility_tons_hr;

-- can only handle in day (12 operating hours)
-- 255.3 = handling tons/hr
handling:=((1.89 + 1.67*LCbh)*ceil(facility_tons_hr/2/255.3))/facility_tons_hr/2 + 178151/facility_size;

total:=grinding+loading+handling+receiving;
END;
$$ LANGUAGE plpgsql;

-- The total quantity of biomass available from the pfarms for the biorefineries is
-- biomass (BDT) = ye*farm_size(acres)*0.95

-- QUESTIONS for Nathan
-- How can these costs have any kind of fixed prices, when this ranges
-- from 2000-2030?  We need to do inflation for these right?
-- Maybe cost_in_year(in_year,to_year,cost);

-- We still have a problem in that some of our costs are not dependant
-- on the year the stuff is handled.